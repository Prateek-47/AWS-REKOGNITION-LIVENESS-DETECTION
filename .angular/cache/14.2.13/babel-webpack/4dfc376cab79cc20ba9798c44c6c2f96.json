{"ast":null,"code":"import { __awaiter as e } from \"tslib\";\n\nclass t {\n  constructor(e, t = {}) {\n    if (\"undefined\" == typeof MediaRecorder) throw Error(\"MediaRecorder is not supported by this browser\");\n    this._stream = e, this._options = t, this._chunks = [], this._recorder = new MediaRecorder(e, {\n      bitsPerSecond: 1e6\n    }), this._setupCallbacks();\n  }\n\n  getState() {\n    return this._recorder.state;\n  }\n\n  start(e) {\n    this.clearRecordedData(), this.recordingStartApiTimestamp = Date.now(), this._recorder.start(e);\n  }\n\n  stop() {\n    return e(this, void 0, void 0, function* () {\n      return \"recording\" === this.getState() && this._recorder.stop(), this._recorderStopped;\n    });\n  }\n\n  pause() {\n    this._recorder.pause();\n  }\n\n  clearRecordedData() {\n    this._chunks = [];\n  }\n\n  dispatch(e) {\n    this._recorder.dispatchEvent(e);\n  }\n\n  getVideoChunkSize() {\n    return this._chunks.length;\n  }\n\n  _setupCallbacks() {\n    this.videoStream = new ReadableStream({\n      start: e => {\n        this._recorder && (this._recorder.ondataavailable = t => {\n          t.data && t.data.size > 0 && (0 === this._chunks.length && (this.firstChunkTimestamp = Date.now()), this._chunks.push(t.data), e.enqueue(t.data));\n        }, this._recorder.addEventListener(\"clientSesssionInfo\", t => {\n          e.enqueue(t.data.clientInfo);\n        }), this._recorder.addEventListener(\"stopVideo\", () => {\n          e.enqueue(\"stopVideo\");\n        }), this._recorder.addEventListener(\"endStream\", () => {\n          e.close();\n        }));\n      }\n    }), this.recorderStarted = new Promise(e => {\n      this._recorder.onstart = () => {\n        this.recorderStartTimestamp = Date.now(), e();\n      };\n    }), this._recorderStopped = new Promise(e => {\n      this._recorder.onstop = () => {\n        this.recorderEndTimestamp = Date.now(), e();\n      };\n    }), this._recorder.onerror = () => {\n      \"stopped\" !== this.getState() && this.stop();\n    };\n  }\n\n}\n\nexport { t as VideoRecorder };","map":{"version":3,"names":["__awaiter","e","t","constructor","MediaRecorder","Error","_stream","_options","_chunks","_recorder","bitsPerSecond","_setupCallbacks","getState","state","start","clearRecordedData","recordingStartApiTimestamp","Date","now","stop","_recorderStopped","pause","dispatch","dispatchEvent","getVideoChunkSize","length","videoStream","ReadableStream","ondataavailable","data","size","firstChunkTimestamp","push","enqueue","addEventListener","clientInfo","close","recorderStarted","Promise","onstart","recorderStartTimestamp","onstop","recorderEndTimestamp","onerror","VideoRecorder"],"sources":["D:/aws-rekognition-liveness-detection-main/node_modules/@aws-amplify/ui-react-liveness/dist/esm/components/FaceLivenessDetector/service/utils/videoRecorder.mjs"],"sourcesContent":["import{__awaiter as e}from\"tslib\";class t{constructor(e,t={}){if(\"undefined\"==typeof MediaRecorder)throw Error(\"MediaRecorder is not supported by this browser\");this._stream=e,this._options=t,this._chunks=[],this._recorder=new MediaRecorder(e,{bitsPerSecond:1e6}),this._setupCallbacks()}getState(){return this._recorder.state}start(e){this.clearRecordedData(),this.recordingStartApiTimestamp=Date.now(),this._recorder.start(e)}stop(){return e(this,void 0,void 0,(function*(){return\"recording\"===this.getState()&&this._recorder.stop(),this._recorderStopped}))}pause(){this._recorder.pause()}clearRecordedData(){this._chunks=[]}dispatch(e){this._recorder.dispatchEvent(e)}getVideoChunkSize(){return this._chunks.length}_setupCallbacks(){this.videoStream=new ReadableStream({start:e=>{this._recorder&&(this._recorder.ondataavailable=t=>{t.data&&t.data.size>0&&(0===this._chunks.length&&(this.firstChunkTimestamp=Date.now()),this._chunks.push(t.data),e.enqueue(t.data))},this._recorder.addEventListener(\"clientSesssionInfo\",(t=>{e.enqueue(t.data.clientInfo)})),this._recorder.addEventListener(\"stopVideo\",(()=>{e.enqueue(\"stopVideo\")})),this._recorder.addEventListener(\"endStream\",(()=>{e.close()})))}}),this.recorderStarted=new Promise((e=>{this._recorder.onstart=()=>{this.recorderStartTimestamp=Date.now(),e()}})),this._recorderStopped=new Promise((e=>{this._recorder.onstop=()=>{this.recorderEndTimestamp=Date.now(),e()}})),this._recorder.onerror=()=>{\"stopped\"!==this.getState()&&this.stop()}}}export{t as VideoRecorder};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}