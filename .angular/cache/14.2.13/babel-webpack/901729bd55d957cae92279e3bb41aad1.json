{"ast":null,"code":"import _asyncToGenerator from \"D:/aws-rekognition-liveness-detection-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport const awsAuthMiddleware = options => (next, context) => /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (args) {\n    if (!HttpRequest.isInstance(args.request)) return next(args);\n    const authScheme = context.endpointV2?.properties?.authSchemes?.[0];\n    const multiRegionOverride = authScheme?.name === \"sigv4a\" ? authScheme?.signingRegionSet?.join(\",\") : undefined;\n    const signer = yield options.signer(authScheme);\n    const output = yield next({ ...args,\n      request: yield signer.sign(args.request, {\n        signingDate: getSkewCorrectedDate(options.systemClockOffset),\n        signingRegion: multiRegionOverride || context[\"signing_region\"],\n        signingService: context[\"signing_service\"]\n      })\n    }).catch(error => {\n      const serverTime = error.ServerTime ?? getDateHeader(error.$response);\n\n      if (serverTime) {\n        options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n      }\n\n      throw error;\n    });\n    const dateHeader = getDateHeader(output.response);\n\n    if (dateHeader) {\n      options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n    }\n\n    return output;\n  });\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nconst getDateHeader = response => HttpResponse.isInstance(response) ? response.headers?.date ?? response.headers?.Date : undefined;\n\nexport const awsAuthMiddlewareOptions = {\n  name: \"awsAuthMiddleware\",\n  tags: [\"SIGNATURE\", \"AWSAUTH\"],\n  relation: \"after\",\n  toMiddleware: \"retryMiddleware\",\n  override: true\n};\nexport const getAwsAuthPlugin = options => ({\n  applyToStack: clientStack => {\n    clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n  }\n});\nexport const getSigV4AuthPlugin = getAwsAuthPlugin;","map":{"version":3,"names":["HttpRequest","HttpResponse","getSkewCorrectedDate","getUpdatedSystemClockOffset","awsAuthMiddleware","options","next","context","args","isInstance","request","authScheme","endpointV2","properties","authSchemes","multiRegionOverride","name","signingRegionSet","join","undefined","signer","output","sign","signingDate","systemClockOffset","signingRegion","signingService","catch","error","serverTime","ServerTime","getDateHeader","$response","dateHeader","response","headers","date","Date","awsAuthMiddlewareOptions","tags","relation","toMiddleware","override","getAwsAuthPlugin","applyToStack","clientStack","addRelativeTo","getSigV4AuthPlugin"],"sources":["D:/aws-rekognition-liveness-detection-main/node_modules/@aws-sdk/middleware-signing/dist-es/awsAuthMiddleware.js"],"sourcesContent":["import { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport const awsAuthMiddleware = (options) => (next, context) => async function (args) {\n    if (!HttpRequest.isInstance(args.request))\n        return next(args);\n    const authScheme = context.endpointV2?.properties?.authSchemes?.[0];\n    const multiRegionOverride = authScheme?.name === \"sigv4a\" ? authScheme?.signingRegionSet?.join(\",\") : undefined;\n    const signer = await options.signer(authScheme);\n    const output = await next({\n        ...args,\n        request: await signer.sign(args.request, {\n            signingDate: getSkewCorrectedDate(options.systemClockOffset),\n            signingRegion: multiRegionOverride || context[\"signing_region\"],\n            signingService: context[\"signing_service\"],\n        }),\n    }).catch((error) => {\n        const serverTime = error.ServerTime ?? getDateHeader(error.$response);\n        if (serverTime) {\n            options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n        }\n        throw error;\n    });\n    const dateHeader = getDateHeader(output.response);\n    if (dateHeader) {\n        options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n    }\n    return output;\n};\nconst getDateHeader = (response) => HttpResponse.isInstance(response) ? response.headers?.date ?? response.headers?.Date : undefined;\nexport const awsAuthMiddlewareOptions = {\n    name: \"awsAuthMiddleware\",\n    tags: [\"SIGNATURE\", \"AWSAUTH\"],\n    relation: \"after\",\n    toMiddleware: \"retryMiddleware\",\n    override: true,\n};\nexport const getAwsAuthPlugin = (options) => ({\n    applyToStack: (clientStack) => {\n        clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n    },\n});\nexport const getSigV4AuthPlugin = getAwsAuthPlugin;\n"],"mappings":";AAAA,SAASA,WAAT,EAAsBC,YAAtB,QAA0C,wBAA1C;AACA,SAASC,oBAAT,QAAqC,8BAArC;AACA,SAASC,2BAAT,QAA4C,qCAA5C;AACA,OAAO,MAAMC,iBAAiB,GAAIC,OAAD,IAAa,CAACC,IAAD,EAAOC,OAAP;EAAA,6BAAmB,WAAgBC,IAAhB,EAAsB;IACnF,IAAI,CAACR,WAAW,CAACS,UAAZ,CAAuBD,IAAI,CAACE,OAA5B,CAAL,EACI,OAAOJ,IAAI,CAACE,IAAD,CAAX;IACJ,MAAMG,UAAU,GAAGJ,OAAO,CAACK,UAAR,EAAoBC,UAApB,EAAgCC,WAAhC,GAA8C,CAA9C,CAAnB;IACA,MAAMC,mBAAmB,GAAGJ,UAAU,EAAEK,IAAZ,KAAqB,QAArB,GAAgCL,UAAU,EAAEM,gBAAZ,EAA8BC,IAA9B,CAAmC,GAAnC,CAAhC,GAA0EC,SAAtG;IACA,MAAMC,MAAM,SAASf,OAAO,CAACe,MAAR,CAAeT,UAAf,CAArB;IACA,MAAMU,MAAM,SAASf,IAAI,CAAC,EACtB,GAAGE,IADmB;MAEtBE,OAAO,QAAQU,MAAM,CAACE,IAAP,CAAYd,IAAI,CAACE,OAAjB,EAA0B;QACrCa,WAAW,EAAErB,oBAAoB,CAACG,OAAO,CAACmB,iBAAT,CADI;QAErCC,aAAa,EAAEV,mBAAmB,IAAIR,OAAO,CAAC,gBAAD,CAFR;QAGrCmB,cAAc,EAAEnB,OAAO,CAAC,iBAAD;MAHc,CAA1B;IAFO,CAAD,CAAJ,CAOlBoB,KAPkB,CAOXC,KAAD,IAAW;MAChB,MAAMC,UAAU,GAAGD,KAAK,CAACE,UAAN,IAAoBC,aAAa,CAACH,KAAK,CAACI,SAAP,CAApD;;MACA,IAAIH,UAAJ,EAAgB;QACZxB,OAAO,CAACmB,iBAAR,GAA4BrB,2BAA2B,CAAC0B,UAAD,EAAaxB,OAAO,CAACmB,iBAArB,CAAvD;MACH;;MACD,MAAMI,KAAN;IACH,CAboB,CAArB;IAcA,MAAMK,UAAU,GAAGF,aAAa,CAACV,MAAM,CAACa,QAAR,CAAhC;;IACA,IAAID,UAAJ,EAAgB;MACZ5B,OAAO,CAACmB,iBAAR,GAA4BrB,2BAA2B,CAAC8B,UAAD,EAAa5B,OAAO,CAACmB,iBAArB,CAAvD;IACH;;IACD,OAAOH,MAAP;EACH,CAzB6C;;EAAA;IAAA;EAAA;AAAA,GAAvC;;AA0BP,MAAMU,aAAa,GAAIG,QAAD,IAAcjC,YAAY,CAACQ,UAAb,CAAwByB,QAAxB,IAAoCA,QAAQ,CAACC,OAAT,EAAkBC,IAAlB,IAA0BF,QAAQ,CAACC,OAAT,EAAkBE,IAAhF,GAAuFlB,SAA3H;;AACA,OAAO,MAAMmB,wBAAwB,GAAG;EACpCtB,IAAI,EAAE,mBAD8B;EAEpCuB,IAAI,EAAE,CAAC,WAAD,EAAc,SAAd,CAF8B;EAGpCC,QAAQ,EAAE,OAH0B;EAIpCC,YAAY,EAAE,iBAJsB;EAKpCC,QAAQ,EAAE;AAL0B,CAAjC;AAOP,OAAO,MAAMC,gBAAgB,GAAItC,OAAD,KAAc;EAC1CuC,YAAY,EAAGC,WAAD,IAAiB;IAC3BA,WAAW,CAACC,aAAZ,CAA0B1C,iBAAiB,CAACC,OAAD,CAA3C,EAAsDiC,wBAAtD;EACH;AAHyC,CAAd,CAAzB;AAKP,OAAO,MAAMS,kBAAkB,GAAGJ,gBAA3B"},"metadata":{},"sourceType":"module"}