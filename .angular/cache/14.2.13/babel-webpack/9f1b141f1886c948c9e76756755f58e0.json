{"ast":null,"code":"import { __awaiter as e, __asyncValues as t } from \"tslib\";\nimport { createMachine as a, assign as o, spawn as i, actions as r } from \"xstate\";\nimport { getBoundingBox as s, getColorsSequencesFromSessionInformation as n, LivenessErrorStateStringMap as c, isCameraDeviceVirtual as d, getFaceMatchState as l, isFaceDistanceBelowThreshold as v, estimateIllumination as m, getOvalDetailsFromSessionInformation as h, generateBboxFromLandmarks as g, drawLivenessOvalInCanvas as u, getOvalBoundingBox as f, getIntersectionOverUnion as S, getFaceMatchStateInLivenessOval as p, getStaticLivenessOvalDetails as F } from \"../utils/liveness.mjs\";\nimport { FaceMatchState as D } from \"../types/liveness.mjs\";\nimport { LivenessErrorState as E } from \"../types/error.mjs\";\nimport { BlazeFaceFaceDetection as A } from \"../utils/blazefaceFaceDetection.mjs\";\nimport { LivenessStreamProvider as M } from \"../utils/streamProvider.mjs\";\nimport { FreshnessColorDisplay as R } from \"../utils/freshnessColorDisplay.mjs\";\nimport { nanoid as C } from \"nanoid\";\nimport { isServerSesssionInformationEvent as P, isDisconnectionEvent as T, isValidationExceptionEvent as O, isInternalServerExceptionEvent as w, isThrottlingExceptionEvent as I, isServiceQuotaExceededExceptionEvent as y, isInvalidSignatureRegionException as b } from \"../utils/eventUtils.mjs\";\nconst k = 500;\nlet B;\n\nconst j = a({\n  id: \"livenessMachine\",\n  initial: \"start\",\n  predictableActionArguments: !0,\n  context: {\n    challengeId: C(),\n    maxFailedAttempts: 0,\n    failedAttempts: 0,\n    componentProps: void 0,\n    serverSessionInformation: void 0,\n    videoAssociatedParams: void 0,\n    ovalAssociatedParams: void 0,\n    faceMatchAssociatedParams: {\n      illuminationState: void 0,\n      faceMatchState: void 0,\n      faceMatchPercentage: 25,\n      currentDetectedFace: void 0,\n      startFace: void 0,\n      endFace: void 0,\n      initialFaceMatchTime: void 0\n    },\n    freshnessColorAssociatedParams: {\n      freshnessColorEl: void 0,\n      freshnessColors: [],\n      freshnessColorsComplete: !1,\n      freshnessColorDisplay: void 0\n    },\n    errorState: void 0,\n    livenessStreamProvider: void 0,\n    responseStreamActorRef: void 0,\n    shouldDisconnect: !1,\n    faceMatchStateBeforeStart: void 0,\n    isFaceFarEnoughBeforeRecording: void 0,\n    isRecordingStopped: !1\n  },\n  on: {\n    CANCEL: \"userCancel\",\n    TIMEOUT: {\n      target: \"retryableTimeout\",\n      actions: \"updateErrorStateForTimeout\"\n    },\n    SET_SESSION_INFO: {\n      internal: !0,\n      actions: \"updateSessionInfo\"\n    },\n    DISCONNECT_EVENT: {\n      internal: !0,\n      actions: \"updateShouldDisconnect\"\n    },\n    SET_DOM_AND_CAMERA_DETAILS: {\n      actions: \"setDOMAndCameraDetails\"\n    },\n    SERVER_ERROR: {\n      target: \"error\",\n      actions: \"updateErrorStateForServer\"\n    },\n    MOBILE_LANDSCAPE_WARNING: {\n      target: \"mobileLandscapeWarning\",\n      actions: \"updateErrorStateForServer\"\n    }\n  },\n  states: {\n    start: {\n      on: {\n        BEGIN: \"cameraCheck\"\n      }\n    },\n    cameraCheck: {\n      entry: [\"resetErrorState\", \"setVideoConstraints\", \"initializeFaceDetector\"],\n      invoke: {\n        src: \"checkVirtualCameraAndGetStream\",\n        onDone: {\n          target: \"waitForDOMAndCameraDetails\",\n          actions: [\"updateVideoMediaStream\"]\n        },\n        onError: {\n          target: \"permissionDenied\"\n        }\n      }\n    },\n    waitForDOMAndCameraDetails: {\n      after: {\n        0: {\n          target: \"detectFaceBeforeStart\",\n          cond: \"hasDOMAndCameraDetails\"\n        },\n        500: {\n          target: \"waitForDOMAndCameraDetails\"\n        }\n      }\n    },\n    detectFaceBeforeStart: {\n      invoke: {\n        src: \"detectFace\",\n        onDone: {\n          target: \"checkFaceDetectedBeforeStart\",\n          actions: [\"updateFaceMatchBeforeStartDetails\"]\n        }\n      }\n    },\n    checkFaceDetectedBeforeStart: {\n      after: {\n        0: {\n          target: \"detectFaceDistanceBeforeRecording\",\n          cond: \"hasSingleFaceBeforeStart\"\n        },\n        100: {\n          target: \"detectFaceBeforeStart\"\n        }\n      }\n    },\n    detectFaceDistanceBeforeRecording: {\n      invoke: {\n        src: \"detectFaceDistance\",\n        onDone: {\n          target: \"checkFaceDistanceBeforeRecording\",\n          actions: [\"updateFaceDistanceBeforeRecording\"]\n        }\n      }\n    },\n    checkFaceDistanceBeforeRecording: {\n      after: {\n        0: {\n          target: \"initializeLivenessStream\",\n          cond: \"hasEnoughFaceDistanceBeforeRecording\"\n        },\n        100: {\n          target: \"detectFaceDistanceBeforeRecording\"\n        }\n      }\n    },\n    initializeLivenessStream: {\n      invoke: {\n        src: \"openLivenessStreamConnection\",\n        onDone: {\n          target: \"waitForSessionInfo\",\n          actions: [\"updateLivenessStreamProvider\", \"spawnResponseStreamActor\"]\n        }\n      }\n    },\n    waitForSessionInfo: {\n      after: {\n        0: {\n          target: \"notRecording\",\n          cond: \"hasServerSessionInfo\"\n        },\n        100: {\n          target: \"waitForSessionInfo\"\n        }\n      }\n    },\n    notRecording: {\n      on: {\n        START_RECORDING: \"recording\"\n      },\n      initial: \"detectFaceDistanceDuringCountdown\",\n      states: {\n        detectFaceDistanceDuringCountdown: {\n          invoke: {\n            src: \"detectFaceDistance\",\n            onDone: {\n              target: \"checkFaceDistanceDuringCountdown\",\n              actions: [\"updateFaceDistanceBeforeRecording\"]\n            }\n          }\n        },\n        checkFaceDistanceDuringCountdown: {\n          after: {\n            0: {\n              target: \"failure\",\n              cond: \"hasNotEnoughFaceDistanceBeforeRecording\"\n            },\n            200: {\n              target: \"detectFaceDistanceDuringCountdown\"\n            }\n          }\n        },\n        failure: {\n          entry: \"sendTimeoutAfterFaceDistanceDelay\",\n          type: \"final\"\n        }\n      }\n    },\n    recording: {\n      entry: [\"clearErrorState\", \"startRecording\"],\n      initial: \"ovalDrawing\",\n      states: {\n        ovalDrawing: {\n          entry: [\"sendTimeoutAfterOvalDrawingDelay\"],\n          invoke: {\n            src: \"detectInitialFaceAndDrawOval\",\n            onDone: {\n              target: \"checkFaceDetected\",\n              actions: [\"updateOvalAndFaceDetailsPostDraw\", \"sendTimeoutAfterOvalMatchDelay\"]\n            },\n            onError: {\n              target: \"#livenessMachine.error\",\n              actions: \"updateErrorStateForRuntime\"\n            }\n          }\n        },\n        checkFaceDetected: {\n          after: {\n            0: {\n              target: \"checkRecordingStarted\",\n              cond: \"hasSingleFace\"\n            },\n            100: {\n              target: \"ovalDrawing\"\n            }\n          }\n        },\n        checkRecordingStarted: {\n          after: {\n            0: {\n              target: \"ovalMatching\",\n              cond: \"hasRecordingStarted\",\n              actions: [\"updateRecordingStartTimestampMs\"]\n            },\n            100: {\n              target: \"checkRecordingStarted\"\n            }\n          }\n        },\n        ovalMatching: {\n          entry: [\"cancelOvalDrawingTimeout\"],\n          invoke: {\n            src: \"detectFaceAndMatchOval\",\n            onDone: {\n              target: \"checkMatch\",\n              actions: \"updateFaceDetailsPostMatch\"\n            }\n          }\n        },\n        checkMatch: {\n          after: {\n            0: {\n              target: \"flashFreshnessColors\",\n              cond: \"hasFaceMatchedInOvalWithMinTime\",\n              actions: [\"updateEndFaceMatch\", \"setupFlashFreshnessColors\", \"cancelOvalMatchTimeout\", \"cancelOvalDrawingTimeout\"]\n            },\n            .1: {\n              target: \"ovalMatching\",\n              cond: \"hasFaceMatchedInOval\",\n              actions: \"setFaceMatchTimeAndStartFace\"\n            },\n            1: {\n              target: \"ovalMatching\",\n              cond: \"hasNotFaceMatchedInOval\"\n            }\n          }\n        },\n        flashFreshnessColors: {\n          invoke: {\n            src: \"flashColors\",\n            onDone: [{\n              target: \"success\",\n              cond: \"hasFreshnessColorShown\"\n            }, {\n              target: \"flashFreshnessColors\",\n              actions: \"updateFreshnessDetails\"\n            }]\n          }\n        },\n        success: {\n          entry: [\"stopRecording\"],\n          type: \"final\"\n        }\n      },\n      onDone: \"uploading\"\n    },\n    uploading: {\n      initial: \"pending\",\n      states: {\n        pending: {\n          entry: [\"sendTimeoutAfterWaitingForDisconnect\", \"pauseVideoStream\"],\n          invoke: {\n            src: \"stopVideo\",\n            onDone: \"waitForDisconnectEvent\",\n            onError: {\n              target: \"#livenessMachine.error\",\n              actions: \"updateErrorStateForRuntime\"\n            }\n          }\n        },\n        waitForDisconnectEvent: {\n          after: {\n            0: {\n              target: \"getLivenessResult\",\n              cond: \"getShouldDisconnect\"\n            },\n            100: {\n              target: \"waitForDisconnectEvent\"\n            }\n          }\n        },\n        getLivenessResult: {\n          entry: [\"cancelWaitForDisconnectTimeout\", \"freezeStream\"],\n          invoke: {\n            src: \"getLiveness\",\n            onError: {\n              target: \"#livenessMachine.error\",\n              actions: \"updateErrorStateForServer\"\n            }\n          }\n        }\n      }\n    },\n    retryableTimeout: {\n      entry: \"updateFailedAttempts\",\n      always: [{\n        target: \"timeout\",\n        cond: \"shouldTimeoutOnFailedAttempts\"\n      }, {\n        target: \"notRecording\"\n      }]\n    },\n    permissionDenied: {\n      entry: \"callUserPermissionDeniedCallback\",\n      on: {\n        RETRY_CAMERA_CHECK: \"cameraCheck\"\n      }\n    },\n    mobileLandscapeWarning: {\n      entry: \"callMobileLandscapeWarningCallback\",\n      always: [{\n        target: \"error\"\n      }]\n    },\n    timeout: {\n      entry: [\"cleanUpResources\", \"callUserTimeoutCallback\", \"freezeStream\"]\n    },\n    error: {\n      entry: [\"cleanUpResources\", \"callErrorCallback\", \"cancelOvalDrawingTimeout\", \"cancelWaitForDisconnectTimeout\", \"cancelOvalMatchTimeout\", \"freezeStream\"]\n    },\n    userCancel: {\n      entry: [\"cleanUpResources\", \"callUserCancelCallback\", \"resetContext\"],\n      always: [{\n        target: \"start\"\n      }]\n    }\n  }\n}, {\n  actions: {\n    spawnResponseStreamActor: o({\n      responseStreamActorRef: () => i(_)\n    }),\n    updateFailedAttempts: o({\n      failedAttempts: e => e.failedAttempts + 1\n    }),\n    setVideoConstraints: o({\n      videoAssociatedParams: (e, t) => {\n        var a, o;\n        return Object.assign(Object.assign({}, e.videoAssociatedParams), {\n          videoConstraints: (null === (a = t.data) || void 0 === a ? void 0 : a.videoConstraints) || (null === (o = e.videoAssociatedParams) || void 0 === o ? void 0 : o.videoConstraints)\n        });\n      }\n    }),\n    updateVideoMediaStream: o({\n      videoAssociatedParams: (e, t) => {\n        var a;\n        return Object.assign(Object.assign({}, e.videoAssociatedParams), {\n          videoMediaStream: null === (a = t.data) || void 0 === a ? void 0 : a.stream\n        });\n      }\n    }),\n    initializeFaceDetector: o({\n      ovalAssociatedParams: e => {\n        const {\n          componentProps: t\n        } = e,\n              {\n          faceModelUrl: a,\n          binaryPath: o\n        } = t.config,\n              i = new A(o, a);\n        return i.triggerModelLoading(), Object.assign(Object.assign({}, e.ovalAssociatedParams), {\n          faceDetector: i\n        });\n      }\n    }),\n    updateLivenessStreamProvider: o({\n      livenessStreamProvider: (e, t) => {\n        var a;\n        return null === (a = t.data) || void 0 === a ? void 0 : a.livenessStreamProvider;\n      }\n    }),\n    setDOMAndCameraDetails: o({\n      videoAssociatedParams: (e, t) => {\n        var a, o, i;\n        return Object.assign(Object.assign({}, e.videoAssociatedParams), {\n          videoEl: null === (a = t.data) || void 0 === a ? void 0 : a.videoEl,\n          canvasEl: null === (o = t.data) || void 0 === o ? void 0 : o.canvasEl,\n          isMobile: null === (i = t.data) || void 0 === i ? void 0 : i.isMobile\n        });\n      },\n      freshnessColorAssociatedParams: (e, t) => {\n        var a;\n        return Object.assign(Object.assign({}, e.freshnessColorAssociatedParams), {\n          freshnessColorEl: null === (a = t.data) || void 0 === a ? void 0 : a.freshnessColorEl\n        });\n      }\n    }),\n    updateRecordingStartTimestampMs: o({\n      videoAssociatedParams: e => {\n        const {\n          challengeId: t,\n          videoAssociatedParams: a,\n          ovalAssociatedParams: o,\n          livenessStreamProvider: i\n        } = e,\n              {\n          recordingStartApiTimestamp: r,\n          recorderStartTimestamp: n\n        } = i.videoRecorder,\n              {\n          videoMediaStream: c\n        } = a,\n              {\n          initialFace: d\n        } = o,\n              l = Math.round(.73 * (n - r) + r),\n              {\n          width: v,\n          height: m\n        } = c.getTracks()[0].getSettings(),\n              h = v - d.left - d.width;\n        return e.livenessStreamProvider.sendClientInfo({\n          Challenge: {\n            FaceMovementAndLightChallenge: {\n              ChallengeId: t,\n              VideoStartTimestamp: l,\n              InitialFace: {\n                InitialFaceDetectedTimestamp: d.timestampMs,\n                BoundingBox: s({\n                  deviceHeight: m,\n                  deviceWidth: v,\n                  height: d.height,\n                  width: d.width,\n                  top: d.top,\n                  left: h\n                })\n              }\n            }\n          }\n        }), Object.assign(Object.assign({}, e.videoAssociatedParams), {\n          recordingStartTimestampMs: l\n        });\n      }\n    }),\n    startRecording: o({\n      videoAssociatedParams: e => {\n        if (!e.serverSessionInformation) throw new Error(\"Session information was not received from response stream\");\n        return e.livenessStreamProvider.videoRecorder && \"recording\" !== e.livenessStreamProvider.videoRecorder.getState() && e.livenessStreamProvider.startRecordingLivenessVideo(), Object.assign({}, e.videoAssociatedParams);\n      }\n    }),\n    stopRecording: e => {},\n    updateFaceMatchBeforeStartDetails: o({\n      faceMatchStateBeforeStart: (e, t) => t.data.faceMatchState\n    }),\n    updateFaceDistanceBeforeRecording: o({\n      isFaceFarEnoughBeforeRecording: (e, t) => t.data.isFaceFarEnoughBeforeRecording\n    }),\n    updateOvalAndFaceDetailsPostDraw: o({\n      ovalAssociatedParams: (e, t) => Object.assign(Object.assign({}, e.ovalAssociatedParams), {\n        initialFace: t.data.initialFace,\n        ovalDetails: t.data.ovalDetails,\n        scaleFactor: t.data.scaleFactor\n      }),\n      faceMatchAssociatedParams: (e, t) => Object.assign(Object.assign({}, e.faceMatchAssociatedParams), {\n        faceMatchState: t.data.faceMatchState,\n        illuminationState: t.data.illuminationState\n      })\n    }),\n    updateFaceDetailsPostMatch: o({\n      faceMatchAssociatedParams: (e, t) => Object.assign(Object.assign({}, e.faceMatchAssociatedParams), {\n        faceMatchState: t.data.faceMatchState,\n        faceMatchPercentage: t.data.faceMatchPercentage,\n        illuminationState: t.data.illuminationState,\n        currentDetectedFace: t.data.detectedFace\n      })\n    }),\n    updateEndFaceMatch: o({\n      faceMatchAssociatedParams: e => Object.assign(Object.assign({}, e.faceMatchAssociatedParams), {\n        endFace: e.faceMatchAssociatedParams.currentDetectedFace\n      })\n    }),\n    setFaceMatchTimeAndStartFace: o({\n      faceMatchAssociatedParams: e => Object.assign(Object.assign({}, e.faceMatchAssociatedParams), {\n        startFace: void 0 === e.faceMatchAssociatedParams.startFace ? e.faceMatchAssociatedParams.currentDetectedFace : e.faceMatchAssociatedParams.startFace,\n        initialFaceMatchTime: void 0 === e.faceMatchAssociatedParams.initialFaceMatchTime ? Date.now() : e.faceMatchAssociatedParams.initialFaceMatchTime\n      })\n    }),\n    resetErrorState: o({\n      errorState: e => {}\n    }),\n    updateErrorStateForTimeout: o({\n      errorState: (e, t) => {\n        var a;\n        return (null === (a = t.data) || void 0 === a ? void 0 : a.errorState) || E.TIMEOUT;\n      }\n    }),\n    updateErrorStateForRuntime: o({\n      errorState: e => E.RUNTIME_ERROR\n    }),\n    updateErrorStateForServer: o({\n      errorState: e => E.SERVER_ERROR\n    }),\n    clearErrorState: o({\n      errorState: e => {}\n    }),\n    updateSessionInfo: o({\n      serverSessionInformation: (e, t) => t.data.sessionInfo\n    }),\n    updateShouldDisconnect: o({\n      shouldDisconnect: e => !0\n    }),\n    updateFreshnessDetails: o({\n      freshnessColorAssociatedParams: (e, t) => Object.assign(Object.assign({}, e.freshnessColorAssociatedParams), {\n        freshnessColorsComplete: t.data.freshnessColorsComplete\n      })\n    }),\n    setupFlashFreshnessColors: o({\n      freshnessColorAssociatedParams: e => {\n        const {\n          serverSessionInformation: t\n        } = e,\n              a = n(t),\n              o = new R(e, a);\n        return Object.assign(Object.assign({}, e.freshnessColorAssociatedParams), {\n          freshnessColorDisplay: o\n        });\n      }\n    }),\n    sendTimeoutAfterOvalDrawingDelay: r.send({\n      type: \"TIMEOUT\"\n    }, {\n      delay: 5e3,\n      id: \"ovalDrawingTimeout\"\n    }),\n    cancelOvalDrawingTimeout: r.cancel(\"ovalDrawingTimeout\"),\n    sendTimeoutAfterOvalMatchDelay: r.send({\n      type: \"TIMEOUT\"\n    }, {\n      delay: 7e3,\n      id: \"ovalMatchTimeout\"\n    }),\n    cancelOvalMatchTimeout: r.cancel(\"ovalMatchTimeout\"),\n    sendTimeoutAfterWaitingForDisconnect: r.send({\n      type: \"TIMEOUT\",\n      data: {\n        errorState: E.SERVER_ERROR\n      }\n    }, {\n      delay: 2e4,\n      id: \"waitForDisconnectTimeout\"\n    }),\n    cancelWaitForDisconnectTimeout: r.cancel(\"waitForDisconnectTimeout\"),\n    sendTimeoutAfterFaceDistanceDelay: r.send({\n      type: \"TIMEOUT\",\n      data: {\n        errorState: E.FACE_DISTANCE_ERROR\n      }\n    }, {\n      delay: 0,\n      id: \"faceDistanceTimeout\"\n    }),\n    cancelFaceDistanceTimeout: r.cancel(\"faceDistanceTimeout\"),\n    callUserPermissionDeniedCallback: o({\n      errorState: (e, t) => {\n        var a, o;\n        let i;\n        i = t.data.message.includes(\"15 fps\") ? E.CAMERA_FRAMERATE_ERROR : E.CAMERA_ACCESS_ERROR;\n        const r = t.data.message || t.data.Message,\n              s = new Error(r);\n        return s.name = i, null === (o = (a = e.componentProps).onError) || void 0 === o || o.call(a, s), i;\n      }\n    }),\n    callMobileLandscapeWarningCallback: o({\n      errorState: e => E.MOBILE_LANDSCAPE_ERROR\n    }),\n    callUserCancelCallback: t => e(void 0, void 0, void 0, function* () {\n      var e, a;\n      null === (a = (e = t.componentProps).onUserCancel) || void 0 === a || a.call(e);\n    }),\n    callUserTimeoutCallback: t => e(void 0, void 0, void 0, function* () {\n      var e, a;\n      const o = new Error(c[t.errorState]);\n      o.name = t.errorState, null === (a = (e = t.componentProps).onError) || void 0 === a || a.call(e, o);\n    }),\n    callErrorCallback: (t, a) => e(void 0, void 0, void 0, function* () {\n      var e, o, i, r, s, n, c;\n      const d = (null === (o = null === (e = a.data) || void 0 === e ? void 0 : e.error) || void 0 === o ? void 0 : o.message) || (null === (r = null === (i = a.data) || void 0 === i ? void 0 : i.error) || void 0 === r ? void 0 : r.Message) || (null === (s = a.data) || void 0 === s ? void 0 : s.message),\n            l = new Error(d);\n      l.name = t.errorState, null === (c = (n = t.componentProps).onError) || void 0 === c || c.call(n, l);\n    }),\n    cleanUpResources: t => e(void 0, void 0, void 0, function* () {\n      var e;\n      const {\n        freshnessColorEl: a\n      } = t.freshnessColorAssociatedParams;\n      a && (a.style.display = \"none\"), yield null === (e = t.livenessStreamProvider) || void 0 === e ? void 0 : e.endStream();\n    }),\n    freezeStream: t => e(void 0, void 0, void 0, function* () {\n      const {\n        videoMediaStream: e,\n        videoEl: a\n      } = t.videoAssociatedParams;\n      t.isRecordingStopped = !0, null == a || a.pause(), null == e || e.getTracks().forEach(function (e) {\n        e.stop();\n      });\n    }),\n    pauseVideoStream: t => e(void 0, void 0, void 0, function* () {\n      const {\n        videoEl: e\n      } = t.videoAssociatedParams;\n      t.isRecordingStopped = !0, e.pause();\n    }),\n    resetContext: o({\n      challengeId: C(),\n      maxFailedAttempts: 0,\n      failedAttempts: 0,\n      componentProps: e => e.componentProps,\n      serverSessionInformation: e => {},\n      videoAssociatedParams: e => {},\n      ovalAssociatedParams: e => {},\n      errorState: e => {},\n      livenessStreamProvider: e => {},\n      responseStreamActorRef: e => {},\n      shouldDisconnect: !1,\n      faceMatchStateBeforeStart: e => {},\n      isFaceFarEnoughBeforeRecording: e => {},\n      isRecordingStopped: !1\n    })\n  },\n  guards: {\n    shouldTimeoutOnFailedAttempts: e => e.failedAttempts >= e.maxFailedAttempts,\n    hasFaceMatchedInOvalWithMinTime: e => {\n      const {\n        faceMatchState: t,\n        initialFaceMatchTime: a\n      } = e.faceMatchAssociatedParams,\n            o = Date.now() - a;\n      return t === D.MATCHED && o >= 500;\n    },\n    hasFaceMatchedInOval: e => e.faceMatchAssociatedParams.faceMatchState === D.MATCHED,\n    hasNotFaceMatchedInOval: e => e.faceMatchAssociatedParams.faceMatchState !== D.MATCHED,\n    hasSingleFace: e => e.faceMatchAssociatedParams.faceMatchState === D.FACE_IDENTIFIED,\n    hasSingleFaceBeforeStart: e => e.faceMatchStateBeforeStart === D.FACE_IDENTIFIED,\n    hasEnoughFaceDistanceBeforeRecording: e => e.isFaceFarEnoughBeforeRecording,\n    hasNotEnoughFaceDistanceBeforeRecording: e => !e.isFaceFarEnoughBeforeRecording,\n    hasLivenessCheckSucceeded: (e, t, a) => a.state.event.data.isLive,\n    hasFreshnessColorShown: e => e.freshnessColorAssociatedParams.freshnessColorsComplete,\n    hasServerSessionInfo: e => void 0 !== e.serverSessionInformation,\n    hasDOMAndCameraDetails: e => void 0 !== e.videoAssociatedParams.videoEl && void 0 !== e.videoAssociatedParams.canvasEl && void 0 !== e.freshnessColorAssociatedParams.freshnessColorEl,\n    getShouldDisconnect: e => !!e.shouldDisconnect,\n    hasRecordingStarted: e => void 0 !== e.livenessStreamProvider.videoRecorder.firstChunkTimestamp\n  },\n  services: {\n    checkVirtualCameraAndGetStream(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          videoConstraints: e\n        } = t.videoAssociatedParams,\n              a = yield navigator.mediaDevices.getUserMedia({\n          video: e,\n          audio: !1\n        }),\n              o = (yield navigator.mediaDevices.enumerateDevices()).filter(e => \"videoinput\" === e.kind).filter(e => !d(e));\n        if (!o.length) throw new Error(\"No real video devices found\");\n        const i = a.getTracks().filter(e => e.getSettings().frameRate >= 15);\n        if (i.length < 1) throw new Error(\"No camera found with more than 15 fps\");\n        const r = i[0].getSettings().deviceId;\n        let s = a;\n        return o.some(e => e.deviceId === r) || (s = yield navigator.mediaDevices.getUserMedia({\n          video: Object.assign(Object.assign({}, e), {\n            deviceId: {\n              exact: o[0].deviceId\n            }\n          }),\n          audio: !1\n        })), {\n          stream: s\n        };\n      });\n    },\n\n    openLivenessStreamConnection(t) {\n      return e(this, void 0, void 0, function* () {\n        const e = new M(t.componentProps.sessionId, t.componentProps.region, t.videoAssociatedParams.videoMediaStream, t.videoAssociatedParams.videoEl);\n        return B = e.getResponseStream(), {\n          livenessStreamProvider: e\n        };\n      });\n    },\n\n    detectFace(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          videoEl: e\n        } = t.videoAssociatedParams,\n              {\n          faceDetector: a\n        } = t.ovalAssociatedParams;\n\n        try {\n          yield a.modelLoadingPromise;\n        } catch (e) {\n          console.log({\n            err: e\n          });\n        }\n\n        return {\n          faceMatchState: yield l(a, e)\n        };\n      });\n    },\n\n    detectFaceDistance(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          isFaceFarEnoughBeforeRecording: e\n        } = t,\n              {\n          videoEl: a,\n          videoMediaStream: o,\n          isMobile: i\n        } = t.videoAssociatedParams,\n              {\n          faceDetector: r\n        } = t.ovalAssociatedParams,\n              {\n          width: s,\n          height: n\n        } = o.getTracks()[0].getSettings(),\n              c = F({\n          width: s,\n          height: n\n        });\n        return {\n          isFaceFarEnoughBeforeRecording: yield v({\n            faceDetector: r,\n            videoEl: a,\n            ovalDetails: c,\n            reduceThreshold: e,\n            isMobile: i\n          })\n        };\n      });\n    },\n\n    detectInitialFaceAndDrawOval(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          serverSessionInformation: e,\n          livenessStreamProvider: a\n        } = t,\n              {\n          videoEl: o,\n          canvasEl: i,\n          isMobile: r\n        } = t.videoAssociatedParams,\n              {\n          faceDetector: s\n        } = t.ovalAssociatedParams;\n\n        try {\n          yield s.modelLoadingPromise, yield a.videoRecorder.recorderStarted;\n        } catch (e) {\n          console.log({\n            err: e\n          });\n        }\n\n        const n = yield s.detectFaces(o);\n        let c, d, l;\n\n        switch (n.length) {\n          case 0:\n            d = D.CANT_IDENTIFY, l = m(o);\n            break;\n\n          case 1:\n            d = D.FACE_IDENTIFIED, c = n[0];\n            break;\n\n          default:\n            d = D.TOO_MANY;\n        }\n\n        if (!c) return {\n          faceMatchState: d,\n          illuminationState: l\n        };\n        const {\n          width: v,\n          height: f\n        } = o.getBoundingClientRect();\n        r ? (i.width = window.innerWidth, i.height = window.innerHeight) : (i.width = v, i.height = f);\n        const S = v / o.videoWidth,\n              p = h({\n          sessionInformation: e,\n          videoWidth: o.width\n        }),\n              F = g(c, p);\n        return c.top = F.top, c.left = F.left, c.height = F.bottom - F.top, c.width = F.right - F.left, u({\n          canvas: i,\n          oval: p,\n          scaleFactor: S,\n          videoEl: o\n        }), {\n          faceMatchState: d,\n          ovalDetails: p,\n          scaleFactor: S,\n          initialFace: c\n        };\n      });\n    },\n\n    detectFaceAndMatchOval(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          serverSessionInformation: e\n        } = t,\n              {\n          videoEl: a\n        } = t.videoAssociatedParams,\n              {\n          faceDetector: o,\n          ovalDetails: i,\n          initialFace: r\n        } = t.ovalAssociatedParams,\n              s = yield o.detectFaces(a);\n        let n,\n            c,\n            d,\n            l = 0;\n        const v = g(r, i),\n              {\n          ovalBoundingBox: h\n        } = f(i),\n              u = S(v, h);\n\n        switch (s.length) {\n          case 0:\n            n = D.CANT_IDENTIFY, d = m(a);\n            break;\n\n          case 1:\n            {\n              c = s[0];\n              const {\n                faceMatchState: t,\n                faceMatchPercentage: a\n              } = p(c, i, u, e);\n              n = t, l = a;\n              break;\n            }\n\n          default:\n            n = D.TOO_MANY;\n        }\n\n        return {\n          faceMatchState: n,\n          faceMatchPercentage: l,\n          illuminationState: d,\n          detectedFace: c\n        };\n      });\n    },\n\n    flashColors(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          freshnessColorsComplete: e,\n          freshnessColorDisplay: a\n        } = t.freshnessColorAssociatedParams;\n        if (e) return;\n        return {\n          freshnessColorsComplete: yield a.displayColorTick()\n        };\n      });\n    },\n\n    stopVideo(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          challengeId: e,\n          livenessStreamProvider: a\n        } = t,\n              {\n          videoMediaStream: o\n        } = t.videoAssociatedParams,\n              {\n          initialFace: i,\n          ovalDetails: r\n        } = t.ovalAssociatedParams,\n              {\n          startFace: n,\n          endFace: c\n        } = t.faceMatchAssociatedParams,\n              {\n          width: d,\n          height: l\n        } = o.getTracks()[0].getSettings(),\n              v = d - i.left - i.width;\n        yield a.stopVideo();\n        const m = {\n          Challenge: {\n            FaceMovementAndLightChallenge: {\n              ChallengeId: e,\n              InitialFace: {\n                InitialFaceDetectedTimestamp: i.timestampMs,\n                BoundingBox: s({\n                  deviceHeight: l,\n                  deviceWidth: d,\n                  height: i.height,\n                  width: i.width,\n                  top: i.top,\n                  left: v\n                })\n              },\n              TargetFace: {\n                FaceDetectedInTargetPositionStartTimestamp: n.timestampMs,\n                FaceDetectedInTargetPositionEndTimestamp: c.timestampMs,\n                BoundingBox: s({\n                  deviceHeight: l,\n                  deviceWidth: d,\n                  height: r.height,\n                  width: r.width,\n                  top: r.centerY - r.height / 2,\n                  left: r.centerX - r.width / 2\n                })\n              },\n              VideoEndTimestamp: a.videoRecorder.recorderEndTimestamp\n            }\n          }\n        };\n        if (0 === a.videoRecorder.getVideoChunkSize()) throw new Error(\"Video chunks not recorded successfully.\");\n        a.sendClientInfo(m), yield a.dispatchStopVideoEvent();\n      });\n    },\n\n    getLiveness(t) {\n      return e(this, void 0, void 0, function* () {\n        const {\n          onAnalysisComplete: e\n        } = t.componentProps;\n        yield e();\n      });\n    }\n\n  }\n}),\n      _ = a => e(void 0, void 0, void 0, function* () {\n  var e, o, i, r;\n\n  try {\n    const d = yield B;\n\n    try {\n      for (var s, n = !0, c = t(d); !(e = (s = yield c.next()).done);) {\n        r = s.value, n = !1;\n\n        try {\n          const e = r;\n          P(e) ? a({\n            type: \"SET_SESSION_INFO\",\n            data: {\n              sessionInfo: e.ServerSessionInformationEvent.SessionInformation\n            }\n          }) : T(e) ? a({\n            type: \"DISCONNECT_EVENT\"\n          }) : O(e) ? a({\n            type: \"SERVER_ERROR\",\n            data: {\n              error: Object.assign({}, e.ValidationException)\n            }\n          }) : w(e) ? a({\n            type: \"SERVER_ERROR\",\n            data: {\n              error: Object.assign({}, e.InternalServerException)\n            }\n          }) : I(e) ? a({\n            type: \"SERVER_ERROR\",\n            data: {\n              error: Object.assign({}, e.ThrottlingException)\n            }\n          }) : y(e) && a({\n            type: \"SERVER_ERROR\",\n            data: {\n              error: Object.assign({}, e.ServiceQuotaExceededException)\n            }\n          });\n        } finally {\n          n = !0;\n        }\n      }\n    } catch (e) {\n      o = {\n        error: e\n      };\n    } finally {\n      try {\n        n || e || !(i = c.return) || (yield i.call(c));\n      } finally {\n        if (o) throw o.error;\n      }\n    }\n  } catch (e) {\n    let t = e;\n    b(e) && (t = new Error(\"Invalid region in FaceLivenessDetector or credentials are scoped to the wrong region.\")), t instanceof Error && a({\n      type: \"SERVER_ERROR\",\n      data: {\n        error: t\n      }\n    });\n  }\n});\n\nexport { k as MIN_FACE_MATCH_TIME, j as livenessMachine };","map":{"version":3,"names":["__awaiter","e","__asyncValues","t","createMachine","a","assign","o","spawn","i","actions","r","getBoundingBox","s","getColorsSequencesFromSessionInformation","n","LivenessErrorStateStringMap","c","isCameraDeviceVirtual","d","getFaceMatchState","l","isFaceDistanceBelowThreshold","v","estimateIllumination","m","getOvalDetailsFromSessionInformation","h","generateBboxFromLandmarks","g","drawLivenessOvalInCanvas","u","getOvalBoundingBox","f","getIntersectionOverUnion","S","getFaceMatchStateInLivenessOval","p","getStaticLivenessOvalDetails","F","FaceMatchState","D","LivenessErrorState","E","BlazeFaceFaceDetection","A","LivenessStreamProvider","M","FreshnessColorDisplay","R","nanoid","C","isServerSesssionInformationEvent","P","isDisconnectionEvent","T","isValidationExceptionEvent","O","isInternalServerExceptionEvent","w","isThrottlingExceptionEvent","I","isServiceQuotaExceededExceptionEvent","y","isInvalidSignatureRegionException","b","k","B","j","id","initial","predictableActionArguments","context","challengeId","maxFailedAttempts","failedAttempts","componentProps","serverSessionInformation","videoAssociatedParams","ovalAssociatedParams","faceMatchAssociatedParams","illuminationState","faceMatchState","faceMatchPercentage","currentDetectedFace","startFace","endFace","initialFaceMatchTime","freshnessColorAssociatedParams","freshnessColorEl","freshnessColors","freshnessColorsComplete","freshnessColorDisplay","errorState","livenessStreamProvider","responseStreamActorRef","shouldDisconnect","faceMatchStateBeforeStart","isFaceFarEnoughBeforeRecording","isRecordingStopped","on","CANCEL","TIMEOUT","target","SET_SESSION_INFO","internal","DISCONNECT_EVENT","SET_DOM_AND_CAMERA_DETAILS","SERVER_ERROR","MOBILE_LANDSCAPE_WARNING","states","start","BEGIN","cameraCheck","entry","invoke","src","onDone","onError","waitForDOMAndCameraDetails","after","cond","detectFaceBeforeStart","checkFaceDetectedBeforeStart","detectFaceDistanceBeforeRecording","checkFaceDistanceBeforeRecording","initializeLivenessStream","waitForSessionInfo","notRecording","START_RECORDING","detectFaceDistanceDuringCountdown","checkFaceDistanceDuringCountdown","failure","type","recording","ovalDrawing","checkFaceDetected","checkRecordingStarted","ovalMatching","checkMatch","flashFreshnessColors","success","uploading","pending","waitForDisconnectEvent","getLivenessResult","retryableTimeout","always","permissionDenied","RETRY_CAMERA_CHECK","mobileLandscapeWarning","timeout","error","userCancel","spawnResponseStreamActor","_","updateFailedAttempts","setVideoConstraints","Object","videoConstraints","data","updateVideoMediaStream","videoMediaStream","stream","initializeFaceDetector","faceModelUrl","binaryPath","config","triggerModelLoading","faceDetector","updateLivenessStreamProvider","setDOMAndCameraDetails","videoEl","canvasEl","isMobile","updateRecordingStartTimestampMs","recordingStartApiTimestamp","recorderStartTimestamp","videoRecorder","initialFace","Math","round","width","height","getTracks","getSettings","left","sendClientInfo","Challenge","FaceMovementAndLightChallenge","ChallengeId","VideoStartTimestamp","InitialFace","InitialFaceDetectedTimestamp","timestampMs","BoundingBox","deviceHeight","deviceWidth","top","recordingStartTimestampMs","startRecording","Error","getState","startRecordingLivenessVideo","stopRecording","updateFaceMatchBeforeStartDetails","updateFaceDistanceBeforeRecording","updateOvalAndFaceDetailsPostDraw","ovalDetails","scaleFactor","updateFaceDetailsPostMatch","detectedFace","updateEndFaceMatch","setFaceMatchTimeAndStartFace","Date","now","resetErrorState","updateErrorStateForTimeout","updateErrorStateForRuntime","RUNTIME_ERROR","updateErrorStateForServer","clearErrorState","updateSessionInfo","sessionInfo","updateShouldDisconnect","updateFreshnessDetails","setupFlashFreshnessColors","sendTimeoutAfterOvalDrawingDelay","send","delay","cancelOvalDrawingTimeout","cancel","sendTimeoutAfterOvalMatchDelay","cancelOvalMatchTimeout","sendTimeoutAfterWaitingForDisconnect","cancelWaitForDisconnectTimeout","sendTimeoutAfterFaceDistanceDelay","FACE_DISTANCE_ERROR","cancelFaceDistanceTimeout","callUserPermissionDeniedCallback","message","includes","CAMERA_FRAMERATE_ERROR","CAMERA_ACCESS_ERROR","Message","name","call","callMobileLandscapeWarningCallback","MOBILE_LANDSCAPE_ERROR","callUserCancelCallback","onUserCancel","callUserTimeoutCallback","callErrorCallback","cleanUpResources","style","display","endStream","freezeStream","pause","forEach","stop","pauseVideoStream","resetContext","guards","shouldTimeoutOnFailedAttempts","hasFaceMatchedInOvalWithMinTime","MATCHED","hasFaceMatchedInOval","hasNotFaceMatchedInOval","hasSingleFace","FACE_IDENTIFIED","hasSingleFaceBeforeStart","hasEnoughFaceDistanceBeforeRecording","hasNotEnoughFaceDistanceBeforeRecording","hasLivenessCheckSucceeded","state","event","isLive","hasFreshnessColorShown","hasServerSessionInfo","hasDOMAndCameraDetails","getShouldDisconnect","hasRecordingStarted","firstChunkTimestamp","services","checkVirtualCameraAndGetStream","navigator","mediaDevices","getUserMedia","video","audio","enumerateDevices","filter","kind","length","frameRate","deviceId","some","exact","openLivenessStreamConnection","sessionId","region","getResponseStream","detectFace","modelLoadingPromise","console","log","err","detectFaceDistance","reduceThreshold","detectInitialFaceAndDrawOval","recorderStarted","detectFaces","CANT_IDENTIFY","TOO_MANY","getBoundingClientRect","window","innerWidth","innerHeight","videoWidth","sessionInformation","bottom","right","canvas","oval","detectFaceAndMatchOval","ovalBoundingBox","flashColors","displayColorTick","stopVideo","TargetFace","FaceDetectedInTargetPositionStartTimestamp","FaceDetectedInTargetPositionEndTimestamp","centerY","centerX","VideoEndTimestamp","recorderEndTimestamp","getVideoChunkSize","dispatchStopVideoEvent","getLiveness","onAnalysisComplete","next","done","value","ServerSessionInformationEvent","SessionInformation","ValidationException","InternalServerException","ThrottlingException","ServiceQuotaExceededException","return","MIN_FACE_MATCH_TIME","livenessMachine"],"sources":["D:/aws-rekognition-liveness-detection-main/node_modules/@aws-amplify/ui-react-liveness/dist/esm/components/FaceLivenessDetector/service/machine/index.mjs"],"sourcesContent":["import{__awaiter as e,__asyncValues as t}from\"tslib\";import{createMachine as a,assign as o,spawn as i,actions as r}from\"xstate\";import{getBoundingBox as s,getColorsSequencesFromSessionInformation as n,LivenessErrorStateStringMap as c,isCameraDeviceVirtual as d,getFaceMatchState as l,isFaceDistanceBelowThreshold as v,estimateIllumination as m,getOvalDetailsFromSessionInformation as h,generateBboxFromLandmarks as g,drawLivenessOvalInCanvas as u,getOvalBoundingBox as f,getIntersectionOverUnion as S,getFaceMatchStateInLivenessOval as p,getStaticLivenessOvalDetails as F}from\"../utils/liveness.mjs\";import{FaceMatchState as D}from\"../types/liveness.mjs\";import{LivenessErrorState as E}from\"../types/error.mjs\";import{BlazeFaceFaceDetection as A}from\"../utils/blazefaceFaceDetection.mjs\";import{LivenessStreamProvider as M}from\"../utils/streamProvider.mjs\";import{FreshnessColorDisplay as R}from\"../utils/freshnessColorDisplay.mjs\";import{nanoid as C}from\"nanoid\";import{isServerSesssionInformationEvent as P,isDisconnectionEvent as T,isValidationExceptionEvent as O,isInternalServerExceptionEvent as w,isThrottlingExceptionEvent as I,isServiceQuotaExceededExceptionEvent as y,isInvalidSignatureRegionException as b}from\"../utils/eventUtils.mjs\";const k=500;let B;const j=a({id:\"livenessMachine\",initial:\"start\",predictableActionArguments:!0,context:{challengeId:C(),maxFailedAttempts:0,failedAttempts:0,componentProps:void 0,serverSessionInformation:void 0,videoAssociatedParams:void 0,ovalAssociatedParams:void 0,faceMatchAssociatedParams:{illuminationState:void 0,faceMatchState:void 0,faceMatchPercentage:25,currentDetectedFace:void 0,startFace:void 0,endFace:void 0,initialFaceMatchTime:void 0},freshnessColorAssociatedParams:{freshnessColorEl:void 0,freshnessColors:[],freshnessColorsComplete:!1,freshnessColorDisplay:void 0},errorState:void 0,livenessStreamProvider:void 0,responseStreamActorRef:void 0,shouldDisconnect:!1,faceMatchStateBeforeStart:void 0,isFaceFarEnoughBeforeRecording:void 0,isRecordingStopped:!1},on:{CANCEL:\"userCancel\",TIMEOUT:{target:\"retryableTimeout\",actions:\"updateErrorStateForTimeout\"},SET_SESSION_INFO:{internal:!0,actions:\"updateSessionInfo\"},DISCONNECT_EVENT:{internal:!0,actions:\"updateShouldDisconnect\"},SET_DOM_AND_CAMERA_DETAILS:{actions:\"setDOMAndCameraDetails\"},SERVER_ERROR:{target:\"error\",actions:\"updateErrorStateForServer\"},MOBILE_LANDSCAPE_WARNING:{target:\"mobileLandscapeWarning\",actions:\"updateErrorStateForServer\"}},states:{start:{on:{BEGIN:\"cameraCheck\"}},cameraCheck:{entry:[\"resetErrorState\",\"setVideoConstraints\",\"initializeFaceDetector\"],invoke:{src:\"checkVirtualCameraAndGetStream\",onDone:{target:\"waitForDOMAndCameraDetails\",actions:[\"updateVideoMediaStream\"]},onError:{target:\"permissionDenied\"}}},waitForDOMAndCameraDetails:{after:{0:{target:\"detectFaceBeforeStart\",cond:\"hasDOMAndCameraDetails\"},500:{target:\"waitForDOMAndCameraDetails\"}}},detectFaceBeforeStart:{invoke:{src:\"detectFace\",onDone:{target:\"checkFaceDetectedBeforeStart\",actions:[\"updateFaceMatchBeforeStartDetails\"]}}},checkFaceDetectedBeforeStart:{after:{0:{target:\"detectFaceDistanceBeforeRecording\",cond:\"hasSingleFaceBeforeStart\"},100:{target:\"detectFaceBeforeStart\"}}},detectFaceDistanceBeforeRecording:{invoke:{src:\"detectFaceDistance\",onDone:{target:\"checkFaceDistanceBeforeRecording\",actions:[\"updateFaceDistanceBeforeRecording\"]}}},checkFaceDistanceBeforeRecording:{after:{0:{target:\"initializeLivenessStream\",cond:\"hasEnoughFaceDistanceBeforeRecording\"},100:{target:\"detectFaceDistanceBeforeRecording\"}}},initializeLivenessStream:{invoke:{src:\"openLivenessStreamConnection\",onDone:{target:\"waitForSessionInfo\",actions:[\"updateLivenessStreamProvider\",\"spawnResponseStreamActor\"]}}},waitForSessionInfo:{after:{0:{target:\"notRecording\",cond:\"hasServerSessionInfo\"},100:{target:\"waitForSessionInfo\"}}},notRecording:{on:{START_RECORDING:\"recording\"},initial:\"detectFaceDistanceDuringCountdown\",states:{detectFaceDistanceDuringCountdown:{invoke:{src:\"detectFaceDistance\",onDone:{target:\"checkFaceDistanceDuringCountdown\",actions:[\"updateFaceDistanceBeforeRecording\"]}}},checkFaceDistanceDuringCountdown:{after:{0:{target:\"failure\",cond:\"hasNotEnoughFaceDistanceBeforeRecording\"},200:{target:\"detectFaceDistanceDuringCountdown\"}}},failure:{entry:\"sendTimeoutAfterFaceDistanceDelay\",type:\"final\"}}},recording:{entry:[\"clearErrorState\",\"startRecording\"],initial:\"ovalDrawing\",states:{ovalDrawing:{entry:[\"sendTimeoutAfterOvalDrawingDelay\"],invoke:{src:\"detectInitialFaceAndDrawOval\",onDone:{target:\"checkFaceDetected\",actions:[\"updateOvalAndFaceDetailsPostDraw\",\"sendTimeoutAfterOvalMatchDelay\"]},onError:{target:\"#livenessMachine.error\",actions:\"updateErrorStateForRuntime\"}}},checkFaceDetected:{after:{0:{target:\"checkRecordingStarted\",cond:\"hasSingleFace\"},100:{target:\"ovalDrawing\"}}},checkRecordingStarted:{after:{0:{target:\"ovalMatching\",cond:\"hasRecordingStarted\",actions:[\"updateRecordingStartTimestampMs\"]},100:{target:\"checkRecordingStarted\"}}},ovalMatching:{entry:[\"cancelOvalDrawingTimeout\"],invoke:{src:\"detectFaceAndMatchOval\",onDone:{target:\"checkMatch\",actions:\"updateFaceDetailsPostMatch\"}}},checkMatch:{after:{0:{target:\"flashFreshnessColors\",cond:\"hasFaceMatchedInOvalWithMinTime\",actions:[\"updateEndFaceMatch\",\"setupFlashFreshnessColors\",\"cancelOvalMatchTimeout\",\"cancelOvalDrawingTimeout\"]},.1:{target:\"ovalMatching\",cond:\"hasFaceMatchedInOval\",actions:\"setFaceMatchTimeAndStartFace\"},1:{target:\"ovalMatching\",cond:\"hasNotFaceMatchedInOval\"}}},flashFreshnessColors:{invoke:{src:\"flashColors\",onDone:[{target:\"success\",cond:\"hasFreshnessColorShown\"},{target:\"flashFreshnessColors\",actions:\"updateFreshnessDetails\"}]}},success:{entry:[\"stopRecording\"],type:\"final\"}},onDone:\"uploading\"},uploading:{initial:\"pending\",states:{pending:{entry:[\"sendTimeoutAfterWaitingForDisconnect\",\"pauseVideoStream\"],invoke:{src:\"stopVideo\",onDone:\"waitForDisconnectEvent\",onError:{target:\"#livenessMachine.error\",actions:\"updateErrorStateForRuntime\"}}},waitForDisconnectEvent:{after:{0:{target:\"getLivenessResult\",cond:\"getShouldDisconnect\"},100:{target:\"waitForDisconnectEvent\"}}},getLivenessResult:{entry:[\"cancelWaitForDisconnectTimeout\",\"freezeStream\"],invoke:{src:\"getLiveness\",onError:{target:\"#livenessMachine.error\",actions:\"updateErrorStateForServer\"}}}}},retryableTimeout:{entry:\"updateFailedAttempts\",always:[{target:\"timeout\",cond:\"shouldTimeoutOnFailedAttempts\"},{target:\"notRecording\"}]},permissionDenied:{entry:\"callUserPermissionDeniedCallback\",on:{RETRY_CAMERA_CHECK:\"cameraCheck\"}},mobileLandscapeWarning:{entry:\"callMobileLandscapeWarningCallback\",always:[{target:\"error\"}]},timeout:{entry:[\"cleanUpResources\",\"callUserTimeoutCallback\",\"freezeStream\"]},error:{entry:[\"cleanUpResources\",\"callErrorCallback\",\"cancelOvalDrawingTimeout\",\"cancelWaitForDisconnectTimeout\",\"cancelOvalMatchTimeout\",\"freezeStream\"]},userCancel:{entry:[\"cleanUpResources\",\"callUserCancelCallback\",\"resetContext\"],always:[{target:\"start\"}]}}},{actions:{spawnResponseStreamActor:o({responseStreamActorRef:()=>i(_)}),updateFailedAttempts:o({failedAttempts:e=>e.failedAttempts+1}),setVideoConstraints:o({videoAssociatedParams:(e,t)=>{var a,o;return Object.assign(Object.assign({},e.videoAssociatedParams),{videoConstraints:(null===(a=t.data)||void 0===a?void 0:a.videoConstraints)||(null===(o=e.videoAssociatedParams)||void 0===o?void 0:o.videoConstraints)})}}),updateVideoMediaStream:o({videoAssociatedParams:(e,t)=>{var a;return Object.assign(Object.assign({},e.videoAssociatedParams),{videoMediaStream:null===(a=t.data)||void 0===a?void 0:a.stream})}}),initializeFaceDetector:o({ovalAssociatedParams:e=>{const{componentProps:t}=e,{faceModelUrl:a,binaryPath:o}=t.config,i=new A(o,a);return i.triggerModelLoading(),Object.assign(Object.assign({},e.ovalAssociatedParams),{faceDetector:i})}}),updateLivenessStreamProvider:o({livenessStreamProvider:(e,t)=>{var a;return null===(a=t.data)||void 0===a?void 0:a.livenessStreamProvider}}),setDOMAndCameraDetails:o({videoAssociatedParams:(e,t)=>{var a,o,i;return Object.assign(Object.assign({},e.videoAssociatedParams),{videoEl:null===(a=t.data)||void 0===a?void 0:a.videoEl,canvasEl:null===(o=t.data)||void 0===o?void 0:o.canvasEl,isMobile:null===(i=t.data)||void 0===i?void 0:i.isMobile})},freshnessColorAssociatedParams:(e,t)=>{var a;return Object.assign(Object.assign({},e.freshnessColorAssociatedParams),{freshnessColorEl:null===(a=t.data)||void 0===a?void 0:a.freshnessColorEl})}}),updateRecordingStartTimestampMs:o({videoAssociatedParams:e=>{const{challengeId:t,videoAssociatedParams:a,ovalAssociatedParams:o,livenessStreamProvider:i}=e,{recordingStartApiTimestamp:r,recorderStartTimestamp:n}=i.videoRecorder,{videoMediaStream:c}=a,{initialFace:d}=o,l=Math.round(.73*(n-r)+r),{width:v,height:m}=c.getTracks()[0].getSettings(),h=v-d.left-d.width;return e.livenessStreamProvider.sendClientInfo({Challenge:{FaceMovementAndLightChallenge:{ChallengeId:t,VideoStartTimestamp:l,InitialFace:{InitialFaceDetectedTimestamp:d.timestampMs,BoundingBox:s({deviceHeight:m,deviceWidth:v,height:d.height,width:d.width,top:d.top,left:h})}}}}),Object.assign(Object.assign({},e.videoAssociatedParams),{recordingStartTimestampMs:l})}}),startRecording:o({videoAssociatedParams:e=>{if(!e.serverSessionInformation)throw new Error(\"Session information was not received from response stream\");return e.livenessStreamProvider.videoRecorder&&\"recording\"!==e.livenessStreamProvider.videoRecorder.getState()&&e.livenessStreamProvider.startRecordingLivenessVideo(),Object.assign({},e.videoAssociatedParams)}}),stopRecording:e=>{},updateFaceMatchBeforeStartDetails:o({faceMatchStateBeforeStart:(e,t)=>t.data.faceMatchState}),updateFaceDistanceBeforeRecording:o({isFaceFarEnoughBeforeRecording:(e,t)=>t.data.isFaceFarEnoughBeforeRecording}),updateOvalAndFaceDetailsPostDraw:o({ovalAssociatedParams:(e,t)=>Object.assign(Object.assign({},e.ovalAssociatedParams),{initialFace:t.data.initialFace,ovalDetails:t.data.ovalDetails,scaleFactor:t.data.scaleFactor}),faceMatchAssociatedParams:(e,t)=>Object.assign(Object.assign({},e.faceMatchAssociatedParams),{faceMatchState:t.data.faceMatchState,illuminationState:t.data.illuminationState})}),updateFaceDetailsPostMatch:o({faceMatchAssociatedParams:(e,t)=>Object.assign(Object.assign({},e.faceMatchAssociatedParams),{faceMatchState:t.data.faceMatchState,faceMatchPercentage:t.data.faceMatchPercentage,illuminationState:t.data.illuminationState,currentDetectedFace:t.data.detectedFace})}),updateEndFaceMatch:o({faceMatchAssociatedParams:e=>Object.assign(Object.assign({},e.faceMatchAssociatedParams),{endFace:e.faceMatchAssociatedParams.currentDetectedFace})}),setFaceMatchTimeAndStartFace:o({faceMatchAssociatedParams:e=>Object.assign(Object.assign({},e.faceMatchAssociatedParams),{startFace:void 0===e.faceMatchAssociatedParams.startFace?e.faceMatchAssociatedParams.currentDetectedFace:e.faceMatchAssociatedParams.startFace,initialFaceMatchTime:void 0===e.faceMatchAssociatedParams.initialFaceMatchTime?Date.now():e.faceMatchAssociatedParams.initialFaceMatchTime})}),resetErrorState:o({errorState:e=>{}}),updateErrorStateForTimeout:o({errorState:(e,t)=>{var a;return(null===(a=t.data)||void 0===a?void 0:a.errorState)||E.TIMEOUT}}),updateErrorStateForRuntime:o({errorState:e=>E.RUNTIME_ERROR}),updateErrorStateForServer:o({errorState:e=>E.SERVER_ERROR}),clearErrorState:o({errorState:e=>{}}),updateSessionInfo:o({serverSessionInformation:(e,t)=>t.data.sessionInfo}),updateShouldDisconnect:o({shouldDisconnect:e=>!0}),updateFreshnessDetails:o({freshnessColorAssociatedParams:(e,t)=>Object.assign(Object.assign({},e.freshnessColorAssociatedParams),{freshnessColorsComplete:t.data.freshnessColorsComplete})}),setupFlashFreshnessColors:o({freshnessColorAssociatedParams:e=>{const{serverSessionInformation:t}=e,a=n(t),o=new R(e,a);return Object.assign(Object.assign({},e.freshnessColorAssociatedParams),{freshnessColorDisplay:o})}}),sendTimeoutAfterOvalDrawingDelay:r.send({type:\"TIMEOUT\"},{delay:5e3,id:\"ovalDrawingTimeout\"}),cancelOvalDrawingTimeout:r.cancel(\"ovalDrawingTimeout\"),sendTimeoutAfterOvalMatchDelay:r.send({type:\"TIMEOUT\"},{delay:7e3,id:\"ovalMatchTimeout\"}),cancelOvalMatchTimeout:r.cancel(\"ovalMatchTimeout\"),sendTimeoutAfterWaitingForDisconnect:r.send({type:\"TIMEOUT\",data:{errorState:E.SERVER_ERROR}},{delay:2e4,id:\"waitForDisconnectTimeout\"}),cancelWaitForDisconnectTimeout:r.cancel(\"waitForDisconnectTimeout\"),sendTimeoutAfterFaceDistanceDelay:r.send({type:\"TIMEOUT\",data:{errorState:E.FACE_DISTANCE_ERROR}},{delay:0,id:\"faceDistanceTimeout\"}),cancelFaceDistanceTimeout:r.cancel(\"faceDistanceTimeout\"),callUserPermissionDeniedCallback:o({errorState:(e,t)=>{var a,o;let i;i=t.data.message.includes(\"15 fps\")?E.CAMERA_FRAMERATE_ERROR:E.CAMERA_ACCESS_ERROR;const r=t.data.message||t.data.Message,s=new Error(r);return s.name=i,null===(o=(a=e.componentProps).onError)||void 0===o||o.call(a,s),i}}),callMobileLandscapeWarningCallback:o({errorState:e=>E.MOBILE_LANDSCAPE_ERROR}),callUserCancelCallback:t=>e(void 0,void 0,void 0,(function*(){var e,a;null===(a=(e=t.componentProps).onUserCancel)||void 0===a||a.call(e)})),callUserTimeoutCallback:t=>e(void 0,void 0,void 0,(function*(){var e,a;const o=new Error(c[t.errorState]);o.name=t.errorState,null===(a=(e=t.componentProps).onError)||void 0===a||a.call(e,o)})),callErrorCallback:(t,a)=>e(void 0,void 0,void 0,(function*(){var e,o,i,r,s,n,c;const d=(null===(o=null===(e=a.data)||void 0===e?void 0:e.error)||void 0===o?void 0:o.message)||(null===(r=null===(i=a.data)||void 0===i?void 0:i.error)||void 0===r?void 0:r.Message)||(null===(s=a.data)||void 0===s?void 0:s.message),l=new Error(d);l.name=t.errorState,null===(c=(n=t.componentProps).onError)||void 0===c||c.call(n,l)})),cleanUpResources:t=>e(void 0,void 0,void 0,(function*(){var e;const{freshnessColorEl:a}=t.freshnessColorAssociatedParams;a&&(a.style.display=\"none\"),yield null===(e=t.livenessStreamProvider)||void 0===e?void 0:e.endStream()})),freezeStream:t=>e(void 0,void 0,void 0,(function*(){const{videoMediaStream:e,videoEl:a}=t.videoAssociatedParams;t.isRecordingStopped=!0,null==a||a.pause(),null==e||e.getTracks().forEach((function(e){e.stop()}))})),pauseVideoStream:t=>e(void 0,void 0,void 0,(function*(){const{videoEl:e}=t.videoAssociatedParams;t.isRecordingStopped=!0,e.pause()})),resetContext:o({challengeId:C(),maxFailedAttempts:0,failedAttempts:0,componentProps:e=>e.componentProps,serverSessionInformation:e=>{},videoAssociatedParams:e=>{},ovalAssociatedParams:e=>{},errorState:e=>{},livenessStreamProvider:e=>{},responseStreamActorRef:e=>{},shouldDisconnect:!1,faceMatchStateBeforeStart:e=>{},isFaceFarEnoughBeforeRecording:e=>{},isRecordingStopped:!1})},guards:{shouldTimeoutOnFailedAttempts:e=>e.failedAttempts>=e.maxFailedAttempts,hasFaceMatchedInOvalWithMinTime:e=>{const{faceMatchState:t,initialFaceMatchTime:a}=e.faceMatchAssociatedParams,o=Date.now()-a;return t===D.MATCHED&&o>=500},hasFaceMatchedInOval:e=>e.faceMatchAssociatedParams.faceMatchState===D.MATCHED,hasNotFaceMatchedInOval:e=>e.faceMatchAssociatedParams.faceMatchState!==D.MATCHED,hasSingleFace:e=>e.faceMatchAssociatedParams.faceMatchState===D.FACE_IDENTIFIED,hasSingleFaceBeforeStart:e=>e.faceMatchStateBeforeStart===D.FACE_IDENTIFIED,hasEnoughFaceDistanceBeforeRecording:e=>e.isFaceFarEnoughBeforeRecording,hasNotEnoughFaceDistanceBeforeRecording:e=>!e.isFaceFarEnoughBeforeRecording,hasLivenessCheckSucceeded:(e,t,a)=>a.state.event.data.isLive,hasFreshnessColorShown:e=>e.freshnessColorAssociatedParams.freshnessColorsComplete,hasServerSessionInfo:e=>void 0!==e.serverSessionInformation,hasDOMAndCameraDetails:e=>void 0!==e.videoAssociatedParams.videoEl&&void 0!==e.videoAssociatedParams.canvasEl&&void 0!==e.freshnessColorAssociatedParams.freshnessColorEl,getShouldDisconnect:e=>!!e.shouldDisconnect,hasRecordingStarted:e=>void 0!==e.livenessStreamProvider.videoRecorder.firstChunkTimestamp},services:{checkVirtualCameraAndGetStream(t){return e(this,void 0,void 0,(function*(){const{videoConstraints:e}=t.videoAssociatedParams,a=yield navigator.mediaDevices.getUserMedia({video:e,audio:!1}),o=(yield navigator.mediaDevices.enumerateDevices()).filter((e=>\"videoinput\"===e.kind)).filter((e=>!d(e)));if(!o.length)throw new Error(\"No real video devices found\");const i=a.getTracks().filter((e=>e.getSettings().frameRate>=15));if(i.length<1)throw new Error(\"No camera found with more than 15 fps\");const r=i[0].getSettings().deviceId;let s=a;return o.some((e=>e.deviceId===r))||(s=yield navigator.mediaDevices.getUserMedia({video:Object.assign(Object.assign({},e),{deviceId:{exact:o[0].deviceId}}),audio:!1})),{stream:s}}))},openLivenessStreamConnection(t){return e(this,void 0,void 0,(function*(){const e=new M(t.componentProps.sessionId,t.componentProps.region,t.videoAssociatedParams.videoMediaStream,t.videoAssociatedParams.videoEl);return B=e.getResponseStream(),{livenessStreamProvider:e}}))},detectFace(t){return e(this,void 0,void 0,(function*(){const{videoEl:e}=t.videoAssociatedParams,{faceDetector:a}=t.ovalAssociatedParams;try{yield a.modelLoadingPromise}catch(e){console.log({err:e})}return{faceMatchState:yield l(a,e)}}))},detectFaceDistance(t){return e(this,void 0,void 0,(function*(){const{isFaceFarEnoughBeforeRecording:e}=t,{videoEl:a,videoMediaStream:o,isMobile:i}=t.videoAssociatedParams,{faceDetector:r}=t.ovalAssociatedParams,{width:s,height:n}=o.getTracks()[0].getSettings(),c=F({width:s,height:n});return{isFaceFarEnoughBeforeRecording:yield v({faceDetector:r,videoEl:a,ovalDetails:c,reduceThreshold:e,isMobile:i})}}))},detectInitialFaceAndDrawOval(t){return e(this,void 0,void 0,(function*(){const{serverSessionInformation:e,livenessStreamProvider:a}=t,{videoEl:o,canvasEl:i,isMobile:r}=t.videoAssociatedParams,{faceDetector:s}=t.ovalAssociatedParams;try{yield s.modelLoadingPromise,yield a.videoRecorder.recorderStarted}catch(e){console.log({err:e})}const n=yield s.detectFaces(o);let c,d,l;switch(n.length){case 0:d=D.CANT_IDENTIFY,l=m(o);break;case 1:d=D.FACE_IDENTIFIED,c=n[0];break;default:d=D.TOO_MANY}if(!c)return{faceMatchState:d,illuminationState:l};const{width:v,height:f}=o.getBoundingClientRect();r?(i.width=window.innerWidth,i.height=window.innerHeight):(i.width=v,i.height=f);const S=v/o.videoWidth,p=h({sessionInformation:e,videoWidth:o.width}),F=g(c,p);return c.top=F.top,c.left=F.left,c.height=F.bottom-F.top,c.width=F.right-F.left,u({canvas:i,oval:p,scaleFactor:S,videoEl:o}),{faceMatchState:d,ovalDetails:p,scaleFactor:S,initialFace:c}}))},detectFaceAndMatchOval(t){return e(this,void 0,void 0,(function*(){const{serverSessionInformation:e}=t,{videoEl:a}=t.videoAssociatedParams,{faceDetector:o,ovalDetails:i,initialFace:r}=t.ovalAssociatedParams,s=yield o.detectFaces(a);let n,c,d,l=0;const v=g(r,i),{ovalBoundingBox:h}=f(i),u=S(v,h);switch(s.length){case 0:n=D.CANT_IDENTIFY,d=m(a);break;case 1:{c=s[0];const{faceMatchState:t,faceMatchPercentage:a}=p(c,i,u,e);n=t,l=a;break}default:n=D.TOO_MANY}return{faceMatchState:n,faceMatchPercentage:l,illuminationState:d,detectedFace:c}}))},flashColors(t){return e(this,void 0,void 0,(function*(){const{freshnessColorsComplete:e,freshnessColorDisplay:a}=t.freshnessColorAssociatedParams;if(e)return;return{freshnessColorsComplete:yield a.displayColorTick()}}))},stopVideo(t){return e(this,void 0,void 0,(function*(){const{challengeId:e,livenessStreamProvider:a}=t,{videoMediaStream:o}=t.videoAssociatedParams,{initialFace:i,ovalDetails:r}=t.ovalAssociatedParams,{startFace:n,endFace:c}=t.faceMatchAssociatedParams,{width:d,height:l}=o.getTracks()[0].getSettings(),v=d-i.left-i.width;yield a.stopVideo();const m={Challenge:{FaceMovementAndLightChallenge:{ChallengeId:e,InitialFace:{InitialFaceDetectedTimestamp:i.timestampMs,BoundingBox:s({deviceHeight:l,deviceWidth:d,height:i.height,width:i.width,top:i.top,left:v})},TargetFace:{FaceDetectedInTargetPositionStartTimestamp:n.timestampMs,FaceDetectedInTargetPositionEndTimestamp:c.timestampMs,BoundingBox:s({deviceHeight:l,deviceWidth:d,height:r.height,width:r.width,top:r.centerY-r.height/2,left:r.centerX-r.width/2})},VideoEndTimestamp:a.videoRecorder.recorderEndTimestamp}}};if(0===a.videoRecorder.getVideoChunkSize())throw new Error(\"Video chunks not recorded successfully.\");a.sendClientInfo(m),yield a.dispatchStopVideoEvent()}))},getLiveness(t){return e(this,void 0,void 0,(function*(){const{onAnalysisComplete:e}=t.componentProps;yield e()}))}}}),_=a=>e(void 0,void 0,void 0,(function*(){var e,o,i,r;try{const d=yield B;try{for(var s,n=!0,c=t(d);!(e=(s=yield c.next()).done);){r=s.value,n=!1;try{const e=r;P(e)?a({type:\"SET_SESSION_INFO\",data:{sessionInfo:e.ServerSessionInformationEvent.SessionInformation}}):T(e)?a({type:\"DISCONNECT_EVENT\"}):O(e)?a({type:\"SERVER_ERROR\",data:{error:Object.assign({},e.ValidationException)}}):w(e)?a({type:\"SERVER_ERROR\",data:{error:Object.assign({},e.InternalServerException)}}):I(e)?a({type:\"SERVER_ERROR\",data:{error:Object.assign({},e.ThrottlingException)}}):y(e)&&a({type:\"SERVER_ERROR\",data:{error:Object.assign({},e.ServiceQuotaExceededException)}})}finally{n=!0}}}catch(e){o={error:e}}finally{try{n||e||!(i=c.return)||(yield i.call(c))}finally{if(o)throw o.error}}}catch(e){let t=e;b(e)&&(t=new Error(\"Invalid region in FaceLivenessDetector or credentials are scoped to the wrong region.\")),t instanceof Error&&a({type:\"SERVER_ERROR\",data:{error:t}})}}));export{k as MIN_FACE_MATCH_TIME,j as livenessMachine};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}