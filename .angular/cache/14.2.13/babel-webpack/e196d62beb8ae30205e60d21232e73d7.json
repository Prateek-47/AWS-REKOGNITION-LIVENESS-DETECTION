{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { getAmplifyUserAgent } from '@aws-amplify/core';\nimport { getDnsSuffix, jitteredBackoff, getRetryDecider } from '@aws-amplify/core/internals/aws-client-utils';\nimport { parseXmlError } from './utils';\nvar DOMAIN_PATTERN = /^[a-z0-9][a-z0-9\\.\\-]{1,61}[a-z0-9]$/;\nvar IP_ADDRESS_PATTERN = /(\\d+\\.){3}\\d+/;\nvar DOTS_PATTERN = /\\.\\./;\n/**\n * The service name used to sign requests if the API requires authentication.\n */\n\nexport var SERVICE_NAME = 's3';\n/**\n * The endpoint resolver function that returns the endpoint URL for a given region, and input parameters.\n */\n\nvar endpointResolver = function (options, apiInput) {\n  var region = options.region,\n      useAccelerateEndpoint = options.useAccelerateEndpoint,\n      customEndpoint = options.customEndpoint,\n      forcePathStyle = options.forcePathStyle;\n  var endpoint; // 1. get base endpoint\n\n  if (customEndpoint) {\n    endpoint = new URL(customEndpoint);\n  } else if (useAccelerateEndpoint) {\n    if (forcePathStyle) {\n      throw new Error('Path style URLs are not supported with S3 Transfer Acceleration.');\n    }\n\n    endpoint = new URL(\"https://s3-accelerate.\".concat(getDnsSuffix(region)));\n  } else {\n    endpoint = new URL(\"https://s3.\".concat(region, \".\").concat(getDnsSuffix(region)));\n  } // 2. inject bucket name\n\n\n  if (apiInput === null || apiInput === void 0 ? void 0 : apiInput.Bucket) {\n    if (!isDnsCompatibleBucketName(apiInput.Bucket)) {\n      throw new Error(\"Invalid bucket name: \\\"\".concat(apiInput.Bucket, \"\\\".\"));\n    }\n\n    if (forcePathStyle || apiInput.Bucket.includes('.')) {\n      endpoint.pathname = \"/\".concat(apiInput.Bucket);\n    } else {\n      endpoint.host = \"\".concat(apiInput.Bucket, \".\").concat(endpoint.host);\n    }\n  }\n\n  return {\n    url: endpoint\n  };\n};\n/**\n * Determines whether a given string is DNS compliant per the rules outlined by\n * S3. Length, capitaization, and leading dot restrictions are enforced by the\n * DOMAIN_PATTERN regular expression.\n * @internal\n *\n * @see https://github.com/aws/aws-sdk-js-v3/blob/f2da6182298d4d6b02e84fb723492c07c27469a8/packages/middleware-bucket-endpoint/src/bucketHostnameUtils.ts#L39-L48\n * @see https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html\n */\n\n\nexport var isDnsCompatibleBucketName = function (bucketName) {\n  return DOMAIN_PATTERN.test(bucketName) && !IP_ADDRESS_PATTERN.test(bucketName) && !DOTS_PATTERN.test(bucketName);\n};\n/**\n * @internal\n */\n\nexport var defaultConfig = {\n  service: SERVICE_NAME,\n  endpointResolver: endpointResolver,\n  retryDecider: getRetryDecider(parseXmlError),\n  computeDelay: jitteredBackoff,\n  userAgentValue: getAmplifyUserAgent(),\n  useAccelerateEndpoint: false,\n  uriEscapePath: false // Required by S3. See https://github.com/aws/aws-sdk-js-v3/blob/9ba012dfa3a3429aa2db0f90b3b0b3a7a31f9bc3/packages/signature-v4/src/SignatureV4.ts#L76-L83\n\n};","map":{"version":3,"names":["getAmplifyUserAgent","getDnsSuffix","jitteredBackoff","getRetryDecider","parseXmlError","DOMAIN_PATTERN","IP_ADDRESS_PATTERN","DOTS_PATTERN","SERVICE_NAME","endpointResolver","options","apiInput","region","useAccelerateEndpoint","customEndpoint","forcePathStyle","endpoint","URL","Error","concat","Bucket","isDnsCompatibleBucketName","includes","pathname","host","url","bucketName","test","defaultConfig","service","retryDecider","computeDelay","userAgentValue","uriEscapePath"],"sources":["D:/aws-rekognition-liveness-detection-main/node_modules/@aws-amplify/storage/lib-esm/AwsClients/S3/base.js"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { getAmplifyUserAgent } from '@aws-amplify/core';\nimport { getDnsSuffix, jitteredBackoff, getRetryDecider, } from '@aws-amplify/core/internals/aws-client-utils';\nimport { parseXmlError } from './utils';\nvar DOMAIN_PATTERN = /^[a-z0-9][a-z0-9\\.\\-]{1,61}[a-z0-9]$/;\nvar IP_ADDRESS_PATTERN = /(\\d+\\.){3}\\d+/;\nvar DOTS_PATTERN = /\\.\\./;\n/**\n * The service name used to sign requests if the API requires authentication.\n */\nexport var SERVICE_NAME = 's3';\n/**\n * The endpoint resolver function that returns the endpoint URL for a given region, and input parameters.\n */\nvar endpointResolver = function (options, apiInput) {\n    var region = options.region, useAccelerateEndpoint = options.useAccelerateEndpoint, customEndpoint = options.customEndpoint, forcePathStyle = options.forcePathStyle;\n    var endpoint;\n    // 1. get base endpoint\n    if (customEndpoint) {\n        endpoint = new URL(customEndpoint);\n    }\n    else if (useAccelerateEndpoint) {\n        if (forcePathStyle) {\n            throw new Error('Path style URLs are not supported with S3 Transfer Acceleration.');\n        }\n        endpoint = new URL(\"https://s3-accelerate.\".concat(getDnsSuffix(region)));\n    }\n    else {\n        endpoint = new URL(\"https://s3.\".concat(region, \".\").concat(getDnsSuffix(region)));\n    }\n    // 2. inject bucket name\n    if (apiInput === null || apiInput === void 0 ? void 0 : apiInput.Bucket) {\n        if (!isDnsCompatibleBucketName(apiInput.Bucket)) {\n            throw new Error(\"Invalid bucket name: \\\"\".concat(apiInput.Bucket, \"\\\".\"));\n        }\n        if (forcePathStyle || apiInput.Bucket.includes('.')) {\n            endpoint.pathname = \"/\".concat(apiInput.Bucket);\n        }\n        else {\n            endpoint.host = \"\".concat(apiInput.Bucket, \".\").concat(endpoint.host);\n        }\n    }\n    return { url: endpoint };\n};\n/**\n * Determines whether a given string is DNS compliant per the rules outlined by\n * S3. Length, capitaization, and leading dot restrictions are enforced by the\n * DOMAIN_PATTERN regular expression.\n * @internal\n *\n * @see https://github.com/aws/aws-sdk-js-v3/blob/f2da6182298d4d6b02e84fb723492c07c27469a8/packages/middleware-bucket-endpoint/src/bucketHostnameUtils.ts#L39-L48\n * @see https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html\n */\nexport var isDnsCompatibleBucketName = function (bucketName) {\n    return DOMAIN_PATTERN.test(bucketName) &&\n        !IP_ADDRESS_PATTERN.test(bucketName) &&\n        !DOTS_PATTERN.test(bucketName);\n};\n/**\n * @internal\n */\nexport var defaultConfig = {\n    service: SERVICE_NAME,\n    endpointResolver: endpointResolver,\n    retryDecider: getRetryDecider(parseXmlError),\n    computeDelay: jitteredBackoff,\n    userAgentValue: getAmplifyUserAgent(),\n    useAccelerateEndpoint: false,\n    uriEscapePath: false, // Required by S3. See https://github.com/aws/aws-sdk-js-v3/blob/9ba012dfa3a3429aa2db0f90b3b0b3a7a31f9bc3/packages/signature-v4/src/SignatureV4.ts#L76-L83\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}