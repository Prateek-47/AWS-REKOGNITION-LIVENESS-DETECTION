{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { __awaiter, __generator } from \"tslib\";\nimport { MethodEmbed } from '../utils/MethodEmbed';\nimport { ConsoleLogger as Logger, browserOrNode } from '@aws-amplify/core';\nvar logger = new Logger('PageViewTracker');\nvar PREV_URL_KEY = 'aws-amplify-analytics-prevUrl';\n\nvar getUrl = function () {\n  if (!browserOrNode().isBrowser) return '';else return window.location.origin + window.location.pathname;\n};\n\nvar defaultOpts = {\n  enable: false,\n  provider: 'AWSPinpoint',\n  getUrl: getUrl\n};\n\nvar PageViewTracker =\n/** @class */\nfunction () {\n  function PageViewTracker(tracker, opts) {\n    logger.debug('initialize pageview tracker with opts', opts);\n    this._config = Object.assign({}, defaultOpts, opts);\n    this._tracker = tracker;\n    this._hasEnabled = false;\n    this._trackFunc = this._trackFunc.bind(this);\n\n    if (this._config.type === 'SPA') {\n      this._pageViewTrackSPA();\n    } else {\n      this._pageViewTrackDefault();\n    }\n  }\n\n  PageViewTracker.prototype.configure = function (opts) {\n    Object.assign(this._config, opts); // if spa, need to remove those listeners if disabled\n\n    if (this._config.type === 'SPA') {\n      this._pageViewTrackSPA();\n    }\n\n    return this._config;\n  };\n\n  PageViewTracker.prototype._isSameUrl = function () {\n    var prevUrl = sessionStorage.getItem(PREV_URL_KEY);\n\n    var curUrl = this._config.getUrl();\n\n    if (prevUrl === curUrl) {\n      logger.debug('the url is same');\n      return true;\n    } else return false;\n  };\n\n  PageViewTracker.prototype._pageViewTrackDefault = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var url, customAttrs, _a, attributes;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!browserOrNode().isBrowser || !window.addEventListener || !window.sessionStorage) {\n              logger.debug('not in the supported web enviroment');\n              return [2\n              /*return*/\n              ];\n            }\n\n            url = this._config.getUrl();\n            if (!(typeof this._config.attributes === 'function')) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , this._config.attributes()];\n\n          case 1:\n            _a = _b.sent();\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            _a = this._config.attributes;\n            _b.label = 3;\n\n          case 3:\n            customAttrs = _a;\n            attributes = Object.assign({\n              url: url\n            }, customAttrs);\n\n            if (this._config.enable && !this._isSameUrl()) {\n              this._tracker({\n                name: this._config.eventName || 'pageView',\n                attributes: attributes\n              }, this._config.provider).catch(function (e) {\n                logger.debug('Failed to record the page view event', e);\n              });\n\n              sessionStorage.setItem(PREV_URL_KEY, url);\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PageViewTracker.prototype._trackFunc = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var url, customAttrs, _a, attributes;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!browserOrNode().isBrowser || !window.addEventListener || !history.pushState || !window.sessionStorage) {\n              logger.debug('not in the supported web enviroment');\n              return [2\n              /*return*/\n              ];\n            }\n\n            url = this._config.getUrl();\n            if (!(typeof this._config.attributes === 'function')) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , this._config.attributes()];\n\n          case 1:\n            _a = _b.sent();\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            _a = this._config.attributes;\n            _b.label = 3;\n\n          case 3:\n            customAttrs = _a;\n            attributes = Object.assign({\n              url: url\n            }, customAttrs);\n\n            if (!this._isSameUrl()) {\n              this._tracker({\n                name: this._config.eventName || 'pageView',\n                attributes: attributes\n              }, this._config.provider).catch(function (e) {\n                logger.debug('Failed to record the page view event', e);\n              });\n\n              sessionStorage.setItem(PREV_URL_KEY, url);\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PageViewTracker.prototype._pageViewTrackSPA = function () {\n    if (!browserOrNode().isBrowser || !window.addEventListener || !history.pushState) {\n      logger.debug('not in the supported web enviroment');\n      return;\n    }\n\n    if (this._config.enable && !this._hasEnabled) {\n      MethodEmbed.add(history, 'pushState', this._trackFunc);\n      MethodEmbed.add(history, 'replaceState', this._trackFunc);\n      window.addEventListener('popstate', this._trackFunc);\n\n      this._trackFunc();\n\n      this._hasEnabled = true;\n    } else {\n      MethodEmbed.remove(history, 'pushState');\n      MethodEmbed.remove(history, 'replaceState');\n      window.removeEventListener('popstate', this._trackFunc);\n      this._hasEnabled = false;\n    }\n  };\n\n  return PageViewTracker;\n}();\n\nexport { PageViewTracker };","map":{"version":3,"names":["__awaiter","__generator","MethodEmbed","ConsoleLogger","Logger","browserOrNode","logger","PREV_URL_KEY","getUrl","isBrowser","window","location","origin","pathname","defaultOpts","enable","provider","PageViewTracker","tracker","opts","debug","_config","Object","assign","_tracker","_hasEnabled","_trackFunc","bind","type","_pageViewTrackSPA","_pageViewTrackDefault","prototype","configure","_isSameUrl","prevUrl","sessionStorage","getItem","curUrl","url","customAttrs","_a","attributes","_b","label","addEventListener","sent","name","eventName","catch","e","setItem","history","pushState","add","remove","removeEventListener"],"sources":["D:/aws-rekognition-liveness-detection-main/node_modules/@aws-amplify/analytics/lib-esm/trackers/PageViewTracker.js"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { __awaiter, __generator } from \"tslib\";\nimport { MethodEmbed } from '../utils/MethodEmbed';\nimport { ConsoleLogger as Logger, browserOrNode } from '@aws-amplify/core';\nvar logger = new Logger('PageViewTracker');\nvar PREV_URL_KEY = 'aws-amplify-analytics-prevUrl';\nvar getUrl = function () {\n    if (!browserOrNode().isBrowser)\n        return '';\n    else\n        return window.location.origin + window.location.pathname;\n};\nvar defaultOpts = {\n    enable: false,\n    provider: 'AWSPinpoint',\n    getUrl: getUrl,\n};\nvar PageViewTracker = /** @class */ (function () {\n    function PageViewTracker(tracker, opts) {\n        logger.debug('initialize pageview tracker with opts', opts);\n        this._config = Object.assign({}, defaultOpts, opts);\n        this._tracker = tracker;\n        this._hasEnabled = false;\n        this._trackFunc = this._trackFunc.bind(this);\n        if (this._config.type === 'SPA') {\n            this._pageViewTrackSPA();\n        }\n        else {\n            this._pageViewTrackDefault();\n        }\n    }\n    PageViewTracker.prototype.configure = function (opts) {\n        Object.assign(this._config, opts);\n        // if spa, need to remove those listeners if disabled\n        if (this._config.type === 'SPA') {\n            this._pageViewTrackSPA();\n        }\n        return this._config;\n    };\n    PageViewTracker.prototype._isSameUrl = function () {\n        var prevUrl = sessionStorage.getItem(PREV_URL_KEY);\n        var curUrl = this._config.getUrl();\n        if (prevUrl === curUrl) {\n            logger.debug('the url is same');\n            return true;\n        }\n        else\n            return false;\n    };\n    PageViewTracker.prototype._pageViewTrackDefault = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var url, customAttrs, _a, attributes;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!browserOrNode().isBrowser ||\n                            !window.addEventListener ||\n                            !window.sessionStorage) {\n                            logger.debug('not in the supported web enviroment');\n                            return [2 /*return*/];\n                        }\n                        url = this._config.getUrl();\n                        if (!(typeof this._config.attributes === 'function')) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this._config.attributes()];\n                    case 1:\n                        _a = _b.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        _a = this._config.attributes;\n                        _b.label = 3;\n                    case 3:\n                        customAttrs = _a;\n                        attributes = Object.assign({\n                            url: url,\n                        }, customAttrs);\n                        if (this._config.enable && !this._isSameUrl()) {\n                            this._tracker({\n                                name: this._config.eventName || 'pageView',\n                                attributes: attributes,\n                            }, this._config.provider).catch(function (e) {\n                                logger.debug('Failed to record the page view event', e);\n                            });\n                            sessionStorage.setItem(PREV_URL_KEY, url);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PageViewTracker.prototype._trackFunc = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var url, customAttrs, _a, attributes;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!browserOrNode().isBrowser ||\n                            !window.addEventListener ||\n                            !history.pushState ||\n                            !window.sessionStorage) {\n                            logger.debug('not in the supported web enviroment');\n                            return [2 /*return*/];\n                        }\n                        url = this._config.getUrl();\n                        if (!(typeof this._config.attributes === 'function')) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this._config.attributes()];\n                    case 1:\n                        _a = _b.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        _a = this._config.attributes;\n                        _b.label = 3;\n                    case 3:\n                        customAttrs = _a;\n                        attributes = Object.assign({\n                            url: url,\n                        }, customAttrs);\n                        if (!this._isSameUrl()) {\n                            this._tracker({\n                                name: this._config.eventName || 'pageView',\n                                attributes: attributes,\n                            }, this._config.provider).catch(function (e) {\n                                logger.debug('Failed to record the page view event', e);\n                            });\n                            sessionStorage.setItem(PREV_URL_KEY, url);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PageViewTracker.prototype._pageViewTrackSPA = function () {\n        if (!browserOrNode().isBrowser ||\n            !window.addEventListener ||\n            !history.pushState) {\n            logger.debug('not in the supported web enviroment');\n            return;\n        }\n        if (this._config.enable && !this._hasEnabled) {\n            MethodEmbed.add(history, 'pushState', this._trackFunc);\n            MethodEmbed.add(history, 'replaceState', this._trackFunc);\n            window.addEventListener('popstate', this._trackFunc);\n            this._trackFunc();\n            this._hasEnabled = true;\n        }\n        else {\n            MethodEmbed.remove(history, 'pushState');\n            MethodEmbed.remove(history, 'replaceState');\n            window.removeEventListener('popstate', this._trackFunc);\n            this._hasEnabled = false;\n        }\n    };\n    return PageViewTracker;\n}());\nexport { PageViewTracker };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}